# üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ MarketKing

## üìä –°—Ö–µ–º–∞ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                      Docker Network (sail)                   ‚îÇ
‚îÇ                                                              ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îÇ
‚îÇ  ‚îÇ                  laravel.test                       ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ              PHP 8.4 + Laravel 11                   ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ                                                     ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ  ‚Ä¢ REST API                                        ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ  ‚Ä¢ Business Logic                                  ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ  ‚Ä¢ AI/ML Services (EmbeddingService)              ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ                                                     ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ  Port: 80                                          ‚îÇ    ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ
‚îÇ             ‚îÇ             ‚îÇ                                 ‚îÇ
‚îÇ             ‚îÇ             ‚îÇ                                 ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê       ‚îÇ
‚îÇ  ‚îÇ                  ‚îÇ  ‚îÇ                            ‚îÇ       ‚îÇ
‚îÇ  ‚îÇ   PostgreSQL 18  ‚îÇ  ‚îÇ         Redis 7            ‚îÇ       ‚îÇ
‚îÇ  ‚îÇ   + pgvector     ‚îÇ  ‚îÇ       (Alpine)             ‚îÇ       ‚îÇ
‚îÇ  ‚îÇ                  ‚îÇ  ‚îÇ                            ‚îÇ       ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ Vector DB      ‚îÇ  ‚îÇ ‚Ä¢ Cache                   ‚îÇ       ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ Embeddings     ‚îÇ  ‚îÇ ‚Ä¢ Sessions                ‚îÇ       ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ k-NN Search    ‚îÇ  ‚îÇ ‚Ä¢ Queues                  ‚îÇ       ‚îÇ
‚îÇ  ‚îÇ                  ‚îÇ  ‚îÇ                            ‚îÇ       ‚îÇ
‚îÇ  ‚îÇ Port: 5432       ‚îÇ  ‚îÇ Port: 6379                ‚îÇ       ‚îÇ
‚îÇ  ‚îÇ                  ‚îÇ  ‚îÇ                            ‚îÇ       ‚îÇ
‚îÇ  ‚îÇ Volume:          ‚îÇ  ‚îÇ Volume:                   ‚îÇ       ‚îÇ
‚îÇ  ‚îÇ sail-pgsql       ‚îÇ  ‚îÇ sail-redis                ‚îÇ       ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò       ‚îÇ
‚îÇ                                                              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

External Access:
‚îú‚îÄ http://localhost:80     ‚Üí Laravel Application
‚îú‚îÄ localhost:5432          ‚Üí PostgreSQL (pgvector/pgvector:pg18)
‚îî‚îÄ localhost:6379          ‚Üí Redis (redis:7-alpine)
```

## üîÑ –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö

### 1. –°–æ–∑–¥–∞–Ω–∏–µ —ç–º–±—ç–¥–∏–Ω–≥–∞
```
User Request
    ‚Üì
Laravel Controller
    ‚Üì
EmbeddingService
    ‚Üì
OpenAI API (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) ‚Üí –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≤–µ–∫—Ç–æ—Ä–∞
    ‚Üì
Embedding Model ‚Üí Save to PostgreSQL
    ‚Üì
pgvector ‚Üí –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤–µ–∫—Ç–æ—Ä–∞ [1536 dimensions]
```

### 2. –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫
```
Search Query
    ‚Üì
EmbeddingService ‚Üí –ì–µ–Ω–µ—Ä–∞—Ü–∏—è query –≤–µ–∫—Ç–æ—Ä–∞
    ‚Üì
PostgreSQL + pgvector
    ‚Üì
–í–µ–∫—Ç–æ—Ä–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ (cosine distance)
    ‚Üì
Top N –ø–æ—Ö–æ–∂–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
    ‚Üì
Response to User
```

### 3. –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ
```
Request
    ‚Üì
Check Redis Cache
    ‚Üì
‚îú‚îÄ Hit  ‚Üí Return cached data
‚îÇ
‚îî‚îÄ Miss ‚Üí Fetch from PostgreSQL
         ‚Üí Cache in Redis
         ‚Üí Return data
```

## üóÑÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

### PostgreSQL (pgvector)

#### –¢–∞–±–ª–∏—Ü–∞: embeddings
```sql
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Column    ‚îÇ      Type        ‚îÇ    Index   ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ id          ‚îÇ bigint           ‚îÇ PRIMARY    ‚îÇ
‚îÇ title       ‚îÇ varchar(255)     ‚îÇ            ‚îÇ
‚îÇ content     ‚îÇ text             ‚îÇ            ‚îÇ
‚îÇ source      ‚îÇ varchar(255)     ‚îÇ            ‚îÇ
‚îÇ embedding   ‚îÇ vector(1536)     ‚îÇ IVFFlat ‚úì  ‚îÇ
‚îÇ created_at  ‚îÇ timestamp        ‚îÇ            ‚îÇ
‚îÇ updated_at  ‚îÇ timestamp        ‚îÇ            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

–ò–Ω–¥–µ–∫—Å—ã:
‚Ä¢ PRIMARY KEY (id)
‚Ä¢ IVFFLAT INDEX (embedding) –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ k-NN –ø–æ–∏—Å–∫–∞
```

### Redis

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ         Redis Databases             ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ DB 0: Application Cache             ‚îÇ
‚îÇ DB 1: Session Storage               ‚îÇ
‚îÇ DB 2: Queue Jobs                    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## üöÄ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### Models
```
app/Models/
‚îî‚îÄ‚îÄ Embedding.php
    ‚îú‚îÄ‚îÄ findSimilar()         # –í–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫
    ‚îú‚îÄ‚îÄ getVectorStats()      # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
    ‚îî‚îÄ‚îÄ Casts: vector ‚Üî array
```

### Services
```
app/Services/
‚îî‚îÄ‚îÄ EmbeddingService.php
    ‚îú‚îÄ‚îÄ generateEmbedding()           # OpenAI API
    ‚îú‚îÄ‚îÄ createEmbedding()             # –°–æ–∑–¥–∞–Ω–∏–µ
    ‚îú‚îÄ‚îÄ search()                      # –ü–æ–∏—Å–∫
    ‚îú‚îÄ‚îÄ batchCreateEmbeddings()       # –ü–∞–∫–µ—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
    ‚îú‚îÄ‚îÄ findSimilarDocuments()        # –ü–æ—Ö–æ–∂–∏–µ
    ‚îî‚îÄ‚îÄ cosineSimilarity()            # –ú–µ—Ç—Ä–∏–∫–∞
```

### Commands
```
app/Console/Commands/
‚îî‚îÄ‚îÄ TestEmbeddings.php
    ‚îú‚îÄ‚îÄ --create              # –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
    ‚îú‚îÄ‚îÄ --search="query"      # –ü–æ–∏—Å–∫
    ‚îî‚îÄ‚îÄ --stats               # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
```

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### PostgreSQL
- ‚úÖ –ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω –≤ Docker —Å–µ—Ç–∏
- ‚úÖ –ü–∞—Ä–æ–ª—å —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- ‚úÖ Volume –¥–ª—è –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏
- ‚úÖ Healthcheck

### Redis
- ‚úÖ –ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω –≤ Docker —Å–µ—Ç–∏
- ‚úÖ –ë–µ–∑ –≤–Ω–µ—à–Ω–µ–≥–æ –¥–æ—Å—Ç—É–ø–∞ (—Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ Docker)
- ‚úÖ Volume –¥–ª—è –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏
- ‚úÖ Healthcheck

### Laravel
- ‚úÖ Environment variables
- ‚úÖ API rate limiting (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- ‚úÖ CORS configuration

## üìà –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
```
                    Load Balancer
                          ‚Üì
        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
        ‚Üì                 ‚Üì                 ‚Üì
   Laravel 1         Laravel 2         Laravel 3
        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                          ‚Üì
              ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
              ‚Üì                       ‚Üì
        PostgreSQL              Redis Cluster
     (—Å —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–µ–π)          (Master-Slave)
```

### –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
- –£–≤–µ–ª–∏—á–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤ PostgreSQL –¥–ª—è –±–æ–ª—å—à–∏—Ö –≤–µ–∫—Ç–æ—Ä–Ω—ã—Ö –∏–Ω–¥–µ–∫—Å–æ–≤
- –ë–æ–ª—å—à–µ –ø–∞–º—è—Ç–∏ –¥–ª—è Redis –∫–µ—à–∞
- CPU –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —ç–º–±—ç–¥–∏–Ω–≥–æ–≤

## üîß –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

### PostgreSQL + pgvector
```sql
-- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
shared_buffers = 512MB              # –ö–µ—à –¥–∞–Ω–Ω—ã—Ö
effective_cache_size = 2GB          # –û—Ü–µ–Ω–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ–π –ø–∞–º—è—Ç–∏
maintenance_work_mem = 256MB        # –î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏–Ω–¥–µ–∫—Å–æ–≤
work_mem = 64MB                     # –î–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–æ–∫ –∏ joins

-- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏–Ω–¥–µ–∫—Å–æ–≤
CREATE INDEX CONCURRENTLY embeddings_embedding_idx 
ON embeddings 
USING ivfflat (embedding vector_cosine_ops) 
WITH (lists = 100);

-- –ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
VACUUM ANALYZE embeddings;
```

### Redis
```
# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
maxmemory 512mb
maxmemory-policy allkeys-lru
save 900 1                # Snapshot –∫–∞–∂–¥—ã–µ 15 –º–∏–Ω
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### Healthchecks
```bash
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤ docker-compose
PostgreSQL: pg_isready
Redis: redis-cli ping

# –†—É—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
./docker-healthcheck.sh
```

### –ú–µ—Ç—Ä–∏–∫–∏
```bash
# PostgreSQL
docker compose exec pgsql psql -U postgres -d marketking \
  -c "SELECT * FROM pg_stat_user_tables WHERE relname = 'embeddings';"

# Redis
docker compose exec redis redis-cli INFO stats

# –†–∞–∑–º–µ—Ä –∏–Ω–¥–µ–∫—Å–æ–≤
docker compose exec pgsql psql -U postgres -d marketking \
  -c "SELECT pg_size_pretty(pg_relation_size('embeddings_embedding_idx'));"
```

## üîÑ Backup —Å—Ç—Ä–∞—Ç–µ–≥–∏—è

### PostgreSQL
```bash
# –ü–æ–ª–Ω—ã–π –±—ç–∫–∞–ø
docker compose exec pgsql pg_dump -U postgres marketking > backup.sql

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
docker compose exec -T pgsql psql -U postgres marketking < backup.sql
```

### Redis
```bash
# –°–æ–∑–¥–∞—Ç—å snapshot
docker compose exec redis redis-cli BGSAVE

# –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å dump.rdb
docker compose cp redis:/data/dump.rdb ./redis-backup.rdb
```

## üéØ Performance Targets

| –ú–µ—Ç—Ä–∏–∫–∞ | –¶–µ–ª—å |
|---------|------|
| –í–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫ (1k docs) | < 50ms |
| –í–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫ (10k docs) | < 200ms |
| –í–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫ (100k docs) | < 1s |
| Cache hit rate | > 80% |
| PostgreSQL connections | < 100 active |
| Redis memory usage | < 1GB |

## üîÆ –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

- [ ] PostgreSQL –†–µ–ø–ª–∏–∫–∞—Ü–∏—è (Master-Slave)
- [ ] Redis Cluster –¥–ª—è HA
- [ ] Prometheus + Grafana –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- [ ] CI/CD Pipeline
- [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
- [ ] Backup automation
- [ ] Rate limiting
- [ ] API documentation (Swagger/OpenAPI)

